<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Student Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body>

    <div class="dashboard-container">

        <div class="header">
            <h2>{{ name }} ({{ roll_no }})</h2>
            <a href="/logout">Logout</a>
        </div>

        <div class="stats-grid">
            <div class="card">
                Attendance %
                <div class="value">{{ attendance }}%</div>
            </div>

            <div class="card">
                Absent Today
                <div class="value">{{ absent_today }}/6</div>
            </div>

            <div class="card">
                Last Date
                <div class="value">{{ last_leave }}</div>
            </div>

            <div class="card">
                Approval
                <div class="value status-{{ approval_status|lower }}">
                    {{ approval_status }}
                </div>
            </div>
        </div>

        <div class="tabs">
            <button class="tab-btn active" onclick="showTab('apply')">Apply Leave</button>
            <button class="tab-btn" onclick="showTab('status')">Check Status</button>
        </div>

        <div id="apply" class="form-card">
            <form method="POST">
                <input name="student_name" placeholder="Student Name" required>
                <input type="date" name="date" required>
                <input type="number" name="absent_sessions" min="0" max="6" placeholder="Absent Sessions" required>
                <textarea name="reason" placeholder="Reason" required></textarea>
                <button type="submit">Submit</button>
            </form>
        </div>

        <div id="status" class="form-card" style="display:none;">
            <table>
                <tr>
                    <th>Date</th>
                    <th>Absent</th>
                    <th>Status</th>
                </tr>
                {% for r in history %}
                <tr>
                    <td>{{ r.date }}</td>
                    <td>{{ r.absent_sessions }}</td>
                    <td class="status-{{ r.status|lower }}">{{ r.status }}</td>
                </tr>
                {% endfor %}
            </table>
        </div>

    </div>

    <script>
        function showTab(tab) {
            document.getElementById("apply").style.display = tab === 'apply' ? "block" : "none";
            document.getElementById("status").style.display = tab === 'status' ? "block" : "none";
        }
    </script>

</body>

</html>